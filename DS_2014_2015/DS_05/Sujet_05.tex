\documentclass[10pt]{article}
\input{style/coursHeadings}
\input{style/programHeadings}
\input{style/macros_SII}
\input{style/macros_Titres}
\input{style/macros_Frames}

%Si le boolen xp est vrai : compilation pour xabi
%Sinon compilation Damien
\newif\ifprof
\proftrue
%\proffalse

\newif\ifxp
\xptrue
%\xpfalse

\newif\iftd
\tdtrue
%\tdfalse

\usepackage[%
    pdftitle={DS Informatique - Concours Blanc},
    pdfauthor={Xavier Pessoles},
    colorlinks=true,
    linkcolor=blue,
    citecolor=magenta]{hyperref}

\def\discipline{Informatique}
\def\xxtitre{%
\ifxp
Concours Blanc : Informatique
\else
\fi
}

\def\xxsoustitre{%
\ifxp
Autour de données météorologiques
\else
\fi}

\def\xxauteur{%
\ifxp
Xavier \textsc{Pessoles} \\
Adapté de sujet 0 -- CCP PSI
\else
\fi}

\def\xxpied{%
\ifxp
Concours Blanc -- Informatique \\
Simulation des vibrations -- \ifprof P \else E \fi
\else
\fi}




%---------------------------------------------------------------------------


\begin{document}
\ifxp
\input{style/enteteXP}
\else
\input{style/enteteDI}
\fi



 \renewcommand{\baselinestretch}{1.2}
\setlength{\parskip}{2ex plus 0.5ex minus 0.2ex}



\section{Mise en situation}
La structure peut être modélisée par $n$ éléments de masse $m_i$ ($i$ variant de 1 à $n$) reliés  par des liaisons visco-élastiques eux-mêmes modélisés par des un ressort de raideur $k$ en parallèle d'un élément d'amortissement $c$. La structure est supposée unidimensionnelle de longueur $L$. Le nombre d'éléments peut être de l'ordre de plusieurs milliers. 

Le déplacement au cours du temps de l'élément $i$ autour de sa position d'équlibre est noté $u_i(t)$. Une force $f_n(t)$ est appliquée sur l'élément $n$ uniquement. L'extrémité gauche de
la structure est bloquée. Les effets de la pesanteur sont négligés.

Le théorème de la résultante dynamique appliqué à un élément $i$ ($i$ variant de 2 à $n-1$ inclus) s'écrit sous la forme : 
%$$
%m_i\dfrac{\text{d}u_i(t)}{\text{d}t} = 
%-k_i\left(u_i(t)-u_{i-1}(t) \right)   - k_{i+1}\left(u_i(t)-u_{i+1}(t) \right) 
%-c_i\left(u_i(t)-u_{i-1}(t) \right)   - c_{i+1}\left(u_i(t)-u_{i+1}(t) \right) 
%$$

%$$
%m\dfrac{\text{d}^2u_i(t)}{\text{d}t^2} = 
%- k\left(u_i(t)-u_{i-1}(t) \right)   
%- k\left(u_i(t)-u_{i+1}(t) \right) 
%- c\dfrac{\text{d}}{\text{d}t} \left[u_i(t)-u_{i-1}(t) \right]
%- c\dfrac{\text{d}}{\text{d}t} \left[u_i(t)-u_{i+1}(t) \right]
%$$


\begin{equation}
m\dfrac{\text{d}^2u_i(t)}{\text{d}t^2} = 
- 2 k u_i(t)  + k u_{i-1}(t) + k u_{i+1}(t)
- 2c \dfrac{\text{d}u_i(t)}{\text{d}t}   +c \dfrac{\text{d}u_{i-1}(t)}{\text{d}t} +c \dfrac{\text{d}u_{i+1}(t)}{\text{d}t}
\end{equation}

Le théorème de la résultante dynamique appliqué aux éléments 1 et $n$ donne les équations suivantes : 
%$$
%m_1\dfrac{\text{d}u_1(t)}{\text{d}t} = 
%-\left(k_1 + k_2\right) u_1(t) + k_2 u_2 (t) - \left(c_1 + c_2 \right)u_1(t) - c_2 u_2 (t)
%$$
%
%$$
%m_n\dfrac{\text{d}u_n(t)}{\text{d}t} = 
%-k_n\left(u_n(t)-u_{n-1}(t) \right)   - c_n\left(u_n(t)-u_{n-1}(t) \right) +f_n(t)
%$$


\begin{equation}
m\dfrac{\text{d}^2u_1(t)}{\text{d}t^2} = 
- 2k u_1(t) + k u_2 (t) 
-2c \dfrac{\text{d}u_1(t)}{\text{d}t} 
- c \dfrac{\text{d}u_2(t)}{\text{d}t} 
\end{equation}

\begin{equation}
m\dfrac{\text{d}^2u_n(t)}{\text{d}t^2} = 
-k\left(u_n(t)-u_{n-1}(t) \right)   - c\left(\dfrac{\text{d}u_{n}(t)}{\text{d}t}-\dfrac{\text{d}u_{n-1}(t)}{\text{d}t} \right) +f_n(t)
\end{equation}


Dans toute la suite, on imposera $f_n(t)=f_{max} \sin \left(\omega t\right)$.

\section{Résolution d'une équation différentielle}
On s'intéresse tout d'abord à un seul système masse ressort. L'application du théorème de la résultante dynamique en projection sur l'axe de déplacement s'écrit donc 
de la manière suivante : 
$$
m\cdot\ddot{u}(t)+c\cdot \dot{u}(t) + k\cdot u(t) = f(t)
$$

On précise que pour $t\leq 0$, $u(t)=0$, $\dot{u}(t)=0$ et $\ddot{u}(t)=0$.

On pose $\left\{ \begin{array}{l} x(t) = u(t) \\ v(t) = \dot{x}(t)\end{array} \right.$.

\subparagraph{}
\textit{Réécrire l'équation différentielle sous forme d'un système d'équation en fonction de $x(t)$,  $v(t)$, $\dot{x}(t)$ et $\dot{v}(t)$}
\ifprof
\begin{corrige}
On a donc : 
$$
\left\{ 
\begin{array}{l} 
v(t) = \dot{x}(t) \\ 
m\cdot\dot{v}(t)+c\cdot {v}(t) + k\cdot x(t) = f(t)
\end{array} \right.
$$
\end{corrige}
\else
\fi

\subparagraph{}
\textit{En utilisant un schéma d'Euler explicite et l'équation $v(t) = \dot{x}(t)$ 
exprimer la suite $x_{k+1}$ en fonction de $x_k$, $v_k$ et le pas de calcul noté noté $h$.}

\ifprof
\begin{corrige}
On a $\dfrac{dx(t)}{dt} \simeq \dfrac{x_{k+1}-x_k}{h}$. On a donc 
$v_k = \dfrac{x_{k+1}-x_k}{h} \Longleftrightarrow x_{k+1} = h\cdot v_k + x_k$.
\end{corrige}
\else
\fi

%\subparagraph{}
%\textit{En utilisant un schéma d'Euler implicite et l'équation $v(t) = \dot{x}(t)$ 
%exprimer la suite $x_{k+1}$ en fonction de $x_k$, $v_k$ et le pas de calcul noté noté $h$.}
%
%\ifprof
%\begin{corrige}
%On a $\dfrac{dx(t)}{dt} \simeq \dfrac{x_{k}-x_ {k-1}}{h}$. On a donc 
%$v_k = \dfrac{x_{k}-x_{k-1}}{h} \Longleftrightarrow x_{k} = h\cdot v_k + x_{k-1}$.
%\end{corrige}
%\else
%\fi



\subparagraph{}
\textit{En utilisant un schéma d'Euler explicite exprimer alors la suite $v_{k+1}$.}

\ifprof
\begin{corrige}
On a $\dfrac{dv(t)}{dt} \simeq \dfrac{v_{k+1}-v_k}{h}$.  En conséquences, 
$m\cdot\dot{v}(t)+c\cdot {v}(t) + k\cdot x(t) = f(t)$
peut donc se mettre sous la forme suivante :

$$
m\cdot\dfrac{v_{k+1}-v_k}{h}+c\cdot {v_k} + k\cdot x_k = f_k
\Longleftrightarrow 
m\cdot {v_{k+1}}  = f_k h - kh\cdot x_k - c h\cdot {v_k}+v_k
\Longleftrightarrow
 {v_{k+1}}  = \dfrac{h}{m} f_k - \dfrac{kh}{m}x_k +\dfrac{1-ch}{m}v_k
$$

\textit{Remarque :}
$$ 
x_{k+2} 
= h\cdot v_{k+1} + x_{k+1} 
= h \left( \dfrac{h}{m} f_k - \dfrac{kh}{m}x_k +\dfrac{1-ch}{m}v_k \right) + x_{k+1} 
$$
 
$$
x_{k+2} - h \left( \dfrac{h}{m} f_k - \dfrac{kh}{m}x_k +\dfrac{1-ch}{m}v_k \right) - x_{k+1} =0
$$

$$
mx_{k+2} - h^2 f_k +  kh^2 x_k - (1-ch) hv_k  - mx_{k+1} =0
$$

$$
mx_{k+2} - mx_{k+1}   +  kh^2 x_k +(ch-1) hv_k  =h^2 f_k
$$


Par ailleurs, $v_k = \dfrac{x_{k+1}-x_{k}}{h}$

$$
mx_{k+2} - mx_{k+1}   +  kh^2 x_k +(ch-1) (x_{k+1}-x_{k})  =h^2 f_k
$$

$$
mx_{k+2} + (ch-m-1)x_{k+1} +  (kh^2-ch-1) x_{k} = h^2 f_k 
$$

$$
\dfrac{m}{h^2}x_{k+2}  =  f_k + 
\left(\dfrac{1}{h^2}+\dfrac{m}{h^2} -\dfrac{c}{h}\right)x_{k+1} 
+ \left(\dfrac{1}{h^2}+\dfrac{c}{h}-k\right) x_{k}
$$



$$
\dfrac{m}{h^2}x_{k}  =  f_k + 
\left(\dfrac{1}{h^2}+\dfrac{m}{h^2} -\dfrac{c}{h}\right)x_{k-1} 
+ \left(\dfrac{1}{h^2}+\dfrac{c}{h}-k\right) x_{k-2}
$$

\begin{rem}
On peut montrer que $G_k = \left(\dfrac{2M}{h^2}+\dfrac{C}{h} \right)X_{k-1} - \dfrac{M}{h^2} X_{k-2} + F_k $ et $H = \dfrac{M}{h^2} + \dfrac{C}{h} + K$.

$$H\cdot X_k = G_k$$
\end{rem}

\end{corrige}
\else
\fi

\subparagraph{}
\textit{En déduire que la solution de l'équation différentielle peut se mettre sous la forme :
$$
\left\{
\begin{array}{l}
x_{k+1} = \alpha \cdot v_k + \beta \cdot x_k \\
v_{k+1} = \gamma \cdot f_k + \delta  \cdot x_k  + \lambda\cdot v_k \\
\end{array}
\right.
\quad \text{où on explicitera $\alpha$, $\beta$, $\gamma$, $\delta$ et $\lambda$.}
$$
}

\ifprof
\begin{corrige}
Dans ses conditions, on a : 
$$
\alpha  = h \quad \beta = 1 \quad \gamma =\dfrac{h}{m} \quad \delta = -\dfrac{kh}{m} \quad \lambda = \dfrac{1-ch}{m}
$$
\end{corrige}
\else
\fi




\subparagraph{}
\textit{On note \textsf{Tsimu} le temps de simulation et \textsf{h} le pas de temps. Implémenter en Python le fonction \textsf{f\_omega} 
permettant de créer une liste contenant l'ensemble des valeurs prises par la fonction $f_n$. On utilisera une boucle \textsf{while}. Les spécifications de la fonction sont les suivantes : }

\begin{py}
\begin{python}
def f_omega(Tsimu,h,fmax,fsign):
   """
   Entrées :
       * Tsimu (flt) : temps de la simulation en seconde
       * h (flt) : pas de temps de a simulation
       * fmax (flt) : amplitude du signal (en Newton)
       * fsign (flt) : fréquence du signal (en Hertz)
   Sortie : 
       * F (list) : liste des valeurs de la fonction 
          f_n (t)= fmax sin (omega *t)
   """
\end{python}
\end{py}

\ifprof
\begin{corrige}
\begin{py}
\begin{python}
def f_omega(Tsimu,h,fmax,fsign):
   """
   Entrées :
       * Tsimu (flt) : temps de la simulation en seconde
       * h (flt) : pas de temps de a simulation
       * fmax (flt) : amplitude du signal (en Newton)
       * fsign (flt) : fréquence du signal (en Hertz)
   Sortie : 
       * F (list) : liste des valeurs de la fonction 
          f_n (t)= fmax sin (omega *t)
   """
    omega  = 2*math.pi*fsign
    t=0 
    F = []
    while t<Tsimu :
        F.append(fmax*math.sin(omega*t))
        t=t+h
    return F
    
\end{python}
\end{py}

\end{corrige}
\else
\fi


\subparagraph{}
\textit{En utilisant une boucle \textsf{while}, générer, en Python, les listes \textsf{X} et \textsf{V} contenant les termes des suites $x_k$ et $v_k$ ainsi que la liste \textsf{T} contenant le temps. On exprimera les lignes de codes en fonction de $\alpha$, $\beta$, $\gamma$, $\delta$ et $\lambda$.}
\ifprof
\begin{corrige}
\begin{python}
t = 0
T,X,V = [t],[0],[0]
F = f_omega(Tsimu,h,fmax,fsign)
i=0
while t<Tsimu:
    t = t+h
    T.append(t)
    X.append(alpha*V[i]+beta*X[i])
    V.append(gamma*F[i]+delta*X[i]+lambd*V[i])    
    i=i+1

\end{python}
\end{corrige}
\else
\fi


\section{Résolution du problème général}
Le système d'équations différentielles défini dans la première partie peut s'écrire sous forme matricielle :
$$
M \ddot{X}(t) +C \dot{X}(t) +K {X}(t) = F(t) \quad \text{avec} \quad 
X(t)=\left[
\begin{array}{c} 
u_1(t) \\ 
... \\ 
u_n(t) \\
\end{array}\right]
$$

$M$, $C$ et $K$ des matrices carrées de taille $n\times n$.


\subparagraph{}
\textit{En reprenant les équations (1), (2) et (3) déterminer les matrices $M$, $C$, $K$ et $F$.}
\ifprof
\begin{corrige}
\footnotesize{
$$
M =
\begin{pmatrix}
m  &  0 & 0 \\
0  & \ddots &0 \\
0 & 0 &  m \\
 \end{pmatrix}
 \quad
C =
\begin{pmatrix}
2c  & -c &  0 & \cdots & \cdots & \cdots  & 0 \\
-c  & 2c & -c & \ddots &  & 0& \vdots\\
0 & -c  & 2c & \ddots & \ddots &  & \vdots\\
\vdots & \ddots &\ddots & \ddots & \ddots & \ddots & \vdots\\
\vdots &  & \ddots &\ddots& 2c & -c & 0 \\
\vdots & 0 &  & \ddots & -c & 2c & -c\\
0 & \cdots & \cdots & \cdots & 0 & -c & 2c\\
 \end{pmatrix}
 \quad
K =
\begin{pmatrix}
2k  & -k &  0 & \cdots & \cdots & \cdots  & 0 \\
-k & 2k & -k & \ddots &  & 0& \vdots\\
0 & -k  & 2k & \ddots & \ddots &  & \vdots\\
\vdots & \ddots &\ddots & \ddots & \ddots & \ddots & \vdots\\
\vdots &  & \ddots &\ddots& 2k & -k & 0 \\
\vdots & 0 &  & \ddots & -k & 2k & -k\\
0 & \cdots & \cdots & \cdots & 0 & -k & 2k\\
 \end{pmatrix}
 \quad
 F =
 \begin{pmatrix}
 0 \\
 \vdots \\
 0 \\
 f_n(t) 
 \end{pmatrix}
$$}
\end{corrige}
\else
\fi


En appliquant le schéma d'Euler explicite à l'équation différentielle matricielle, on montre qu'à l'instant $k$, le système peut se mettre sous la forme $H\cdot X_k = G_k$, la matrice $H$ étant de la forme suivante (dite tridiagonale) :
$$
H =
\begin{pmatrix}
H_{00}  & H_{01} &  0 & 0 & 0 \\
H_{10}  & H_{11} &  \ddots & 0 & 0 \\
0 & \ddots & \ddots & \ddots & 0 \\
0 & 0 & \ddots & H_{n-1,n-1} & H_{n-1,n} \\
0 & 0 & 0 & H_{n-1,n} & H_{n,n} \\
\end{pmatrix}
 $$

\begin{rem}
On peut montrer que $G_k = \left(\dfrac{2M}{h^2}+\dfrac{C}{h} \right)X_{k-1} - \dfrac{M}{h^2} X_{k-2} + F_k $ et $H = \dfrac{M}{h^2} + \dfrac{C}{h} + K$.
\end{rem}

\subparagraph{}
\textit{L'équation  $H\cdot X_k = G_k$ peut être résolue grâce à la méthode du pivot de Gauss. Donner les étapes de cette méthode ainsi que l'objectif ce chacune d'entre elles. }
\ifprof
\begin{corrige}
\end{corrige}
\else
\fi

\end{document}

\subparagraph{}
\textit{Au vue de la forme de la matrice, il est possible de simplifier l'étape visant à échelonner la matrice. }
\ifprof
\begin{corrige}
\end{corrige}
\else
\fi





 
$$
m\ddot{x}_i -c \dot{x}_{i-1} + 2c \dot{x}_i   -c \dot{x}_{i+1}- k x_{i-1} + 2 k x_i   - k x_{i+1}=0
$$


$$
\begin{array}{l}
m\ddot{x}_1 -c \dot{x}_{1-1} + 2c \dot{x}_1   -c \dot{x}_{1+1}- k x_{1-1} + 2 k x_1   - k x_{1+1}=0 \\
... \\
m\ddot{x}_2 -c \dot{x}_{2-1} + 2c \dot{x}_2   -c \dot{x}_{2+1}- k x_{2-1} + 2 k x_2   - k x_{2+1}=0 \\
m\ddot{x}_3 -c \dot{x}_{3-1} + 2c \dot{x}_3   -c \dot{x}_{3+1}- k x_{3-1} + 2 k x_3   - k x_{3+1}=0 \\
m\ddot{x}_4 -c \dot{x}_{4-1} + 2c \dot{x}_4   -c \dot{x}_{4+1}- k x_{4-1} + 2 k x_4   - k x_{4+1}=0 \\
... \\
m\ddot{x}_n -c \dot{x}_{n-1} + 2c \dot{x}_n   -c \dot{x}_{n+1}- k x_{n-1} + 2 k x_n   - k x_{n+1}=f_n \\
\end{array}
$$


